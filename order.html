<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Complete Your Order</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f4f4;
            padding: 20px;
        }

        .container {
            max-width: 450px;
            background: #fff;
            padding: 20px;
            margin: auto;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            text-align: center;
            margin-bottom: 15px;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        input,
        select {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 15px;
            background: #fff;
            color: #222;
        }

        input[readonly] {
            background: #f8f8f8;
            color: #444;
            font-weight: bold;
        }

        button {
            padding: 12px;
            background: #10a37f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }

        button:hover {
            background: #0a7d60;
        }

        button:disabled {
            background: #7fbfa9;
            cursor: not-allowed;
        }

        .qr-section {
            text-align: center;
            margin-bottom: 15px;
        }

        .qr-section img {
            max-width: 200px;
        }
    </style>

    <!-- Meta Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1281510500113019');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=1281510500113019&ev=PageView&noscript=1" /></noscript>
    <!-- End Meta Pixel Code -->

    
</head>

<body>
    <div class="container">
        <h2>Complete Your Payment</h2>

        <div class="qr-section">
            <p>Scan this QR to Pay:</p>
            <img src="./assets/upi-qr.png.jpg" alt="UPI QR Code">
            <p><strong>UPI ID:</strong> somya2208jain2208@okaxis</p>
        </div>

        <form id="orderForm">
            <input type="text" name="name" placeholder="Your Name" required>
            <input type="email" name="email" placeholder="Your Email" required>
            <input type="tel" name="phone" placeholder="Your Phone" required>

            <!-- Auto-filled Plan -->
            <input type="text" name="plan" id="planInput" readonly required>
            <input type="text" name="amount" id="amountInput" readonly required>

            <input type="text" name="transactionId" placeholder="Transaction ID / UTR" required>
            <input type="file" name="screenshot" accept="image/*">
            <button type="submit">Submit Details</button>
        </form>

        <div class="support-info" style="margin-top:15px; text-align:center; font-size:14px; color:#444;">
            <p>If you face any issue, you can reach us:</p>
            <p>
                <a href="https://t.me/Somya2208" target="_blank">
                    <i class="fab fa-telegram-plane"></i> Telegram
                </a> |
                <a href="https://instagram.com/sabka_premium" target="_blank">
                    <i class="fab fa-instagram"></i> Instagram
                </a> |
                <a href="mailto:sabkapremium01@gmail.com">
                    <i class="fas fa-envelope"></i> Email
                </a>
            </p>
        </div>

    </div>

    <script>
        // Plan Mapping (plan codes → display name and amount)
        const planMap = {
            "ChatGPT-1M-699": { name: "ChatGPT - 1 Month", amount: "699" },
            "ChatGPT-3M-1699": { name: "ChatGPT - 3 Month", amount: "1699" },
            "ChatGPT-3M-299": { name: "ChatGPT - 3 Month", amount: "299" },
            "ChatGPT-6M-499": { name: "ChatGPT - 6 Month", amount: "499" },
            "ChatGPT-12M-899": { name: "ChatGPT - 12 Month", amount: "899" },
            "ChatGPT-3M-549": { name: "ChatGPT - 3 Month", amount: "549" },
            "ChatGPT-6M-899": { name: "ChatGPT - 6 Month", amount: "899" },
            "ChatGPT-12M-1399": { name: "ChatGPT - 12 Month", amount: "1399" },
            "Netflix-1M-249": { name: "Netflix - 1 Month", amount: "249" },
            "Netflix-3M-599": { name: "Netflix - 3 Month", amount: "599" },
            "Netflix-6M-999": { name: "Netflix - 6 Month", amount: "999" },
            "Prime-1M-99": { name: "Prime - 1 Month", amount: "99" },
            "Prime-3M-199": { name: "Prime - 3 Month", amount: "199" },
            "Prime-6M-399": { name: "Prime - 6 Month", amount: "399" },
            "Prime-12M-699": { name: "Prime - 12 Month", amount: "699" },
            "Canva-12M-149": { name: "Canva Pro - 1 Year", amount: "149" },
            "Gemini-1M-199": { name: "Gemini Pro + 2TB Storage - 1 Months", amount: "199" },
            "Gemini-1Y-999": { name: "Gemini Pro + 2TB Storage - 12 Months", amount: "999" },
            "CursorAI-1Y-2499": { name: "Cursor ai pro - 12 Months", amount: "2499" },
            "Software-Bundle-599": { name: "All Preactivated Software – Lifetime", amount: "599" },


        };

        // Get plan from URL and auto-fill inputs
        const urlParams = new URLSearchParams(window.location.search);
        const planCode = urlParams.get("plan");

        if (planCode && planMap[planCode]) {
            document.getElementById("planInput").value = planMap[planCode].name;
            document.getElementById("amountInput").value = "₹" + planMap[planCode].amount;

            // QR Image generate karega
            const amount = planMap[planCode].amount;
            const upiId = "somya2208jain2208@okaxis";   // apna UPI ID
            const name = "Soumya Jain";                 // apna naam

            document.getElementById("qrImage").src =
                `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=${upiId}&pn=${encodeURIComponent(name)}&am=${amount}&cu=INR`;
        }

        // Submit to Google Script
        const form = document.getElementById("orderForm");
        const submitBtn = form.querySelector("button");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            // Disable button & show loading text
            submitBtn.disabled = true;
            submitBtn.textContent = "Submitting... ⏳";

            const formData = new FormData(form);

            // File ko Base64 me convert
            const screenshotFile = formData.get("screenshot");
            let base64String = "";
            if (screenshotFile && screenshotFile.size > 0) {
                base64String = await toBase64(screenshotFile);
            }

            // JSON object create
            const payload = {};
            formData.forEach((value, key) => payload[key] = value);
            payload.screenshotBase64 = base64String.split(",")[1] || ""; // Base64 data only
            payload.screenshotType = screenshotFile ? screenshotFile.type : "";

            // Send JSON
            fetch("https://script.google.com/macros/s/AKfycbz4O6KY0iVgy4XtFmg9NI0fLKWmb3iqISkZReo62UltYcYeyBjsOxWYfE4QtHXOKxky6g/exec", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams(payload)
            })
                .then(() => {
                    alert("Your details have been submitted! We will verify and deliver shortly.");
                    form.reset();
                })
                .catch(err => alert("Error: " + err))
                .finally(() => {
                    // Enable button & reset text
                    submitBtn.disabled = false;
                    submitBtn.textContent = "Submit Details";
                });
        });

        // Helper: File to Base64
        function toBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = (error) => reject(error);
            });
        }

    </script>
</body>

</html>